<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Rtl433-monitor</title>
    <link rel="stylesheet" href="css/base.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.2.0/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <h1>Power</h1>
    <div id="sensor1"></div>
    <div id="sensor2"></div>
    <h1>Temperature</h1>
    <div id="sensor3"></div>
    <div id="sensor4"></div>
    <script type="text/babel">

var SensorReading = React.createClass({
  getInitialState: function() {
    return {
      temperature_C: 'unknown',
      power0: 'unknown',
    };
  },

  componentDidMount: function() {
    var self = this;
    this.socket = io();
    this.socket.on('sensor_event', function (event) {
      if( event[self.props.filterKey] &&
          event[self.props.filterKey] == self.props.filterValue )
      {
        self.setState(event);
      }
    });
  },

  componentWillUnmount: function() {
    //nothing
  },

  render: function() {
    return (
      <div className="sensorReading">
        at {this.state.time}<br/>
        Temperature: {this.state.temperature_C}<br/>
        power0: {this.state.power0}<br/>
      </div>
    );
  }
});

// debug logger
io().on('sensor_event', function (event) {
  console.log('sensor_event', event);
});

ReactDOM.render(
  <SensorReading filterKey='dev_id' filterValue='2115' />,
  document.getElementById('sensor1')
);
ReactDOM.render(
  <SensorReading filterKey='dev_id' filterValue='77' />,
  document.getElementById('sensor2')
);
ReactDOM.render(
  <SensorReading filterKey='id' filterValue='1' />,
  document.getElementById('sensor3')
);
ReactDOM.render(
  <SensorReading filterKey='id' filterValue='150' />,
  document.getElementById('sensor4')
);

    </script>
  </body>
</html>